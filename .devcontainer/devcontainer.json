{
  "name": "ESP-MATTER",
  "image": "espressif/esp-matter:release-v1.4.2_idf_v5.4.1",
  "remoteUser": "root",
  "userEnvProbe": "none",
  "init": true,
  "customizations": {
    "vscode": {
      "settings": {
        "terminal.integrated.defaultProfile.linux": "bash",
        "idf.espIdfPath": "/opt/espressif/esp-idf",
        "idf.toolsPath": "/opt/espressif/tools",
        "idf.espMatterPath": "/opt/espressif/esp-matter",
        "idf.gitPath": "/usr/bin/git",
        "idf.pythonBinPath": "/opt/espressif/tools/python_env/idf5.4_py3.12_env/bin/python",
        "idf.customExtraPaths": "/opt/espressif/esp-idf/tools:/opt/espressif/tools/tools/xtensa-esp-elf/esp-14.2.0_20241119/xtensa-esp-elf/bin:/opt/espressif/tools/tools/esp32ulp-elf/2.38_20240113/esp32ulp-elf/bin",
        "idf.customExtraVars": {
          "IDF_CCACHE_ENABLE": "1",
          "IDF_PATH": "/opt/espressif/esp-idf",
          "ESP_MATTER_PATH": "/opt/espressif/esp-matter"
        }
      },
      "extensions": [
        "espressif.esp-idf-extension",
        "espressif.esp-idf-web",
        "ms-vscode.cpptools",
        "ms-python.python",
        "twxs.cmake"
      ]
    }
  },
  "runArgs": [
    "--privileged",
    "--device=/dev/ttyACM0"
  ],
  "mounts": [
    "source=/dev/bus/usb,target=/dev/bus/usb,type=bind",
    "source=${localEnv:HOME}/.ssh,target=/mnt/host_ssh,type=bind,consistency=cached"
  ],
  "containerEnv": {
    "IDF_PATH": "/opt/espressif/esp-idf",
    "ESP_MATTER_PATH": "/opt/espressif/esp-matter",
    "LC_ALL": "C.UTF-8",
    "LANG": "C.UTF-8"
  },
  "postStartCommand": "bash -lc 'apt-get update -y && apt-get install -y openssh-client && mkdir -p /root/.ssh && if [ -f /mnt/host_ssh/id_personal ]; then cp /mnt/host_ssh/id_personal /root/.ssh/; fi && if [ -f /mnt/host_ssh/id_personal.pub ]; then cp /mnt/host_ssh/id_personal.pub /root/.ssh/; fi && printf \"Host github.com-portilloromano\\n  HostName github.com\\n  User git\\n  IdentityFile /root/.ssh/id_personal\\n  IdentitiesOnly yes\\n\" > /root/.ssh/config && chmod 700 /root/.ssh && chmod 600 /root/.ssh/config || true && if [ -f /root/.ssh/id_personal ]; then chmod 600 /root/.ssh/id_personal; fi && if [ -f /root/.ssh/id_personal.pub ]; then chmod 644 /root/.ssh/id_personal.pub; fi && chown -R root:root /root/.ssh && VENV=/opt/espressif/tools/python_env/idf5.4_py3.12_env && grep -q \"^export PATH=\\\"$VENV/bin:\\$PATH\\\"$\" ~/.bashrc || echo export PATH=\\\"$VENV/bin:\\$PATH\\\" >> ~/.bashrc && grep -q \"esp-idf/export.sh\" ~/.bashrc || echo source $IDF_PATH/export.sh >> ~/.bashrc && grep -q \"esp-matter/export.sh\" ~/.bashrc || echo source $ESP_MATTER_PATH/export.sh >> ~/.bashrc'"
}