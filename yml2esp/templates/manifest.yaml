always:
  templates:
    - template: driver_led_strip.c.j2
      output: main/driver_led_strip.c
    - template: button.c.j2
      output: main/button.c
    - template: app_matter.cpp.j2
      output: main/app_matter.cpp
    - template: main.cpp.j2
      output: main/main.cpp
    - template: CMakeLists.txt.j2
      output: main/CMakeLists.txt

when_wifi:
  when:
    app.network.connectivity: wifi
  templates:
    - template: sdkconfig.j2
      output: main/sdkconfig

when_thread:
  when:
    app.network.connectivity: thread
  templates:
    - template: sdkconfig.j2
      output: main/sdkconfig

# Preferencia 1: si el usuario define esquema OTA, úsalo
partitions_ota:
  when:
    fabrication.partitions.scheme: ota
  templates:
    - template: ../templates/partitions.csv_8MB
      output: main/partitions.csv
      when:
        app.flash_size: 8MB
    - template: ../templates/partitions.csv_16MB
      output: main/partitions.csv
      when:
        app.flash_size: 16MB

# Preferencia 2 (fallback): si no hay 'scheme', usa por tamaño
partitions_4mb:
  when:
    app.flash_size: 4MB
  templates:
    - template: ../templates/partitions.csv_4MB
      output: main/partitions.csv

partitions_8mb:
  when:
    app.flash_size: 8MB
  templates:
    - template: ../templates/partitions.csv_8MB
      output: main/partitions.csv

partitions_16mb:
  when:
    app.flash_size: 16MB
  templates:
    - template: ../templates/partitions.csv_16MB
      output: main/partitions.csv
